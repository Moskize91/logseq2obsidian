# æ—¥æœŸæ ¼å¼ä¿®å¤æ€»ç»“

## é—®é¢˜æè¿°
ç”¨æˆ·åé¦ˆï¼šè½¬æ¢åçš„ Obsidian æ—¥è®°æ–‡ä»¶ä½¿ç”¨ `2025_01_02.md` æ ¼å¼ï¼Œä½† Obsidian é»˜è®¤åº”è¯¥ä½¿ç”¨ `2025-01-02.md` æ ¼å¼ï¼ˆè¿å­—ç¬¦è€Œéä¸‹åˆ’çº¿ï¼‰ã€‚

## æ ¹å› åˆ†æ
1. **LogSeq æ—¥æœŸæ ¼å¼**: LogSeq çš„ journals ç›®å½•ä¸­ä½¿ç”¨ä¸‹åˆ’çº¿æ ¼å¼ `2025_01_02.md`
2. **è½¬æ¢é€»è¾‘ç¼ºå¤±**: åŸä»£ç åªæ˜¯ç®€å•å¤åˆ¶æ–‡ä»¶åï¼Œæ²¡æœ‰é’ˆå¯¹æ—¥æœŸæ ¼å¼çš„ç‰¹æ®Šå¤„ç†
3. **Obsidian æ ‡å‡†**: Obsidian çš„ Daily Notes æ’ä»¶é»˜è®¤ä½¿ç”¨è¿å­—ç¬¦æ ¼å¼ `YYYY-MM-DD`

## è§£å†³æ–¹æ¡ˆ

### 1. ä¿®æ”¹ `generate_filename` æ–¹æ³•
åœ¨ `src/obsidian_formatter.py` ä¸­çš„ `generate_filename` æ–¹æ³•æ·»åŠ æ—¥æœŸæ ¼å¼è½¬æ¢é€»è¾‘ï¼š

```python
def generate_filename(self, original_name: str) -> str:
    """ç”Ÿæˆ Obsidian å…¼å®¹çš„æ–‡ä»¶å"""
    # ç§»é™¤æˆ–æ›¿æ¢ Obsidian ä¸æ”¯æŒçš„å­—ç¬¦
    safe_name = re.sub(r'[<>:"/\\|?*]', '_', original_name)
    
    # è½¬æ¢ LogSeq æ—¥æœŸæ ¼å¼ä¸º Obsidian æ ¼å¼
    # LogSeq: 2025_01_02 -> Obsidian: 2025-01-02
    # åªè½¬æ¢åˆç†çš„æ—¥æœŸæ ¼å¼ï¼ˆå¹´ä»½2000-2099ï¼Œæœˆä»½01-12ï¼Œæ—¥æœŸ01-31ï¼‰
    date_pattern = r'^(20[0-9]{2})_([0-1][0-9])_([0-3][0-9])(.*)$'
    date_match = re.match(date_pattern, safe_name)
    if date_match:
        year, month, day, suffix = date_match.groups()
        # åŸºæœ¬çš„æ—¥æœŸåˆç†æ€§æ£€æŸ¥
        month_int = int(month)
        day_int = int(day)
        if 1 <= month_int <= 12 and 1 <= day_int <= 31:
            safe_name = f"{year}-{month}-{day}{suffix}"
    
    # ç¡®ä¿ .md æ‰©å±•å
    if not safe_name.endswith('.md'):
        safe_name += '.md'
    
    return safe_name
```

### 2. è½¬æ¢è§„åˆ™
- **åŒ¹é…æ¨¡å¼**: `(20[0-9]{2})_([0-1][0-9])_([0-3][0-9])(.*)`
- **å¹´ä»½èŒƒå›´**: 2000-2099
- **æœˆä»½èŒƒå›´**: 01-12ï¼ˆå¿…é¡»æ˜¯ä¸¤ä½æ•°ï¼‰
- **æ—¥æœŸèŒƒå›´**: 01-31ï¼ˆå¿…é¡»æ˜¯ä¸¤ä½æ•°ï¼‰
- **åç¼€æ”¯æŒ**: ä¿ç•™ä»»ä½•åç¼€ï¼ˆå¦‚ `2024_01_06 2.md` â†’ `2024-01-06 2.md`ï¼‰

### 3. å®‰å…¨æ€§è€ƒè™‘
- **ä¸¥æ ¼éªŒè¯**: åªè½¬æ¢ç¬¦åˆæ ‡å‡†æ—¥æœŸæ ¼å¼çš„æ–‡ä»¶å
- **è¾¹ç¼˜æƒ…å†µ**: æ— æ•ˆçš„æ—¥æœŸï¼ˆå¦‚ `2025_13_01`ã€`2025_01_32`ï¼‰ä¿æŒåŸæ ¼å¼
- **éæ—¥æœŸæ–‡ä»¶**: å®Œå…¨ä¸å—å½±å“

## æµ‹è¯•éªŒè¯

### 1. å•å…ƒæµ‹è¯•
åœ¨ `tests/test_filename_processing.py` ä¸­æ·»åŠ äº† `test_date_format_conversion` æ–¹æ³•ï¼š

```python
def test_date_format_conversion(self):
    """æµ‹è¯•LogSeqæ—¥æœŸæ ¼å¼è½¬æ¢ä¸ºObsidianæ ¼å¼"""
    # æµ‹è¯•æ ‡å‡†æ—¥æœŸæ ¼å¼è½¬æ¢
    test_cases = [
        ("2025_01_02", "2025-01-02.md"),
        ("2024_12_31", "2024-12-31.md"),
        ("2024_01_06 2", "2024-01-06 2.md"),  # å¸¦åç¼€
    ]
    
    # æµ‹è¯•éæ—¥æœŸæ–‡ä»¶ä¸å—å½±å“
    non_date_cases = [
        ("normal_file", "normal_file.md"),
        ("2025_1_2", "2025_1_2.md"),      # ä¸æ ‡å‡†æ ¼å¼
        ("2025_13_01", "2025_13_01.md"),  # æ— æ•ˆæœˆä»½
    ]
```

### 2. å®é™…è½¬æ¢æµ‹è¯•
éªŒè¯äº†å®é™…è½¬æ¢è¾“å‡ºï¼š
- **ä¹‹å‰**: `/Daily Notes/2025_01_02.md`
- **ä¹‹å**: `/Daily Notes/2025-01-02.md`

### 3. å›å½’æµ‹è¯•
- âœ… æ‰€æœ‰ç°æœ‰æµ‹è¯•ç»§ç»­é€šè¿‡
- âœ… æ–‡ä»¶åå¤„ç†åŠŸèƒ½æ­£å¸¸
- âœ… éæ—¥æœŸæ–‡ä»¶ä¸å—å½±å“

## è½¬æ¢æ•ˆæœ

### æ–‡ä»¶åå¯¹æ¯”
| LogSeq åŸæ ¼å¼ | Obsidian æ–°æ ¼å¼ | è¯´æ˜ |
|---------------|----------------|------|
| `2025_01_02.md` | `2025-01-02.md` | æ ‡å‡†æ—¥æœŸæ ¼å¼è½¬æ¢ |
| `2024_12_31.md` | `2024-12-31.md` | å¹´åº•æ—¥æœŸ |
| `2024_01_06 2.md` | `2024-01-06 2.md` | å¸¦åç¼€çš„é‡å¤æ–‡ä»¶ |
| `normal_file.md` | `normal_file.md` | éæ—¥æœŸæ–‡ä»¶ä¸å˜ |
| `2025_13_01.md` | `2025_13_01.md` | æ— æ•ˆæœˆä»½ä¿æŒåŸæ · |

### ç›®å½•ç»“æ„
```
obsidian_output/
â”œâ”€â”€ Daily Notes/
â”‚   â”œâ”€â”€ 2025-01-02.md     â† ä½¿ç”¨è¿å­—ç¬¦
â”‚   â”œâ”€â”€ 2025-01-03.md     â† ä½¿ç”¨è¿å­—ç¬¦
â”‚   â””â”€â”€ 2025-01-04.md     â† ä½¿ç”¨è¿å­—ç¬¦
â”œâ”€â”€ Wiki/
â””â”€â”€ å…¶ä»–æ–‡ä»¶.md
```

## å…¼å®¹æ€§

### Obsidian å…¼å®¹æ€§
- âœ… **Daily Notes æ’ä»¶**: å®Œå…¨å…¼å®¹é»˜è®¤çš„ `YYYY-MM-DD` æ ¼å¼
- âœ… **Calendar æ’ä»¶**: å¯ä»¥æ­£ç¡®è¯†åˆ«å’Œå¯¼èˆªæ—¥æœŸæ–‡ä»¶
- âœ… **æ–‡ä»¶é“¾æ¥**: `[[2025-01-02]]` æ ¼å¼çš„å†…éƒ¨é“¾æ¥æ­£å¸¸å·¥ä½œ

### å‘åå…¼å®¹æ€§
- âœ… ä¸å½±å“ç°æœ‰çš„éæ—¥æœŸæ–‡ä»¶å¤„ç†
- âœ… ä¿æŒæ‰€æœ‰å…¶ä»–æ–‡ä»¶åè½¬æ¢è§„åˆ™
- âœ… ä¸æ”¹å˜æ–‡ä»¶å†…å®¹è½¬æ¢é€»è¾‘

## æ€»ç»“

### âœ… å·²å®Œæˆ
1. **æ—¥æœŸæ ¼å¼è½¬æ¢**: LogSeq `2025_01_02` â†’ Obsidian `2025-01-02`
2. **æ™ºèƒ½è¯†åˆ«**: åªè½¬æ¢ç¬¦åˆæ ‡å‡†æ ¼å¼çš„æ—¥æœŸæ–‡ä»¶
3. **å®‰å…¨å¤„ç†**: æ— æ•ˆæ—¥æœŸå’Œéæ—¥æœŸæ–‡ä»¶ä¿æŒä¸å˜
4. **æµ‹è¯•è¦†ç›–**: æ·»åŠ äº†å®Œæ•´çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
5. **å‘åå…¼å®¹**: ä¿æŒæ‰€æœ‰ç°æœ‰åŠŸèƒ½ä¸å˜

### ğŸ¯ æ•ˆæœ
- **ç”¨æˆ·ä½“éªŒ**: è½¬æ¢åçš„æ–‡ä»¶å®Œå…¨ç¬¦åˆ Obsidian æ ‡å‡†
- **æ—¥æœŸå¯¼èˆª**: Obsidian çš„æ—¥æœŸç›¸å…³æ’ä»¶å¯ä»¥æ­£å¸¸å·¥ä½œ
- **æ–‡ä»¶ç»„ç»‡**: Daily Notes æŒ‰æ ‡å‡†æ ¼å¼æ•´é½æ’åˆ—

ç°åœ¨ç”¨æˆ·å¯ä»¥æ— ç¼åœ°å°† LogSeq æ—¥è®°è¿ç§»åˆ° Obsidianï¼Œäº«å—åŸç”Ÿçš„æ—¥æœŸå¯¼èˆªå’Œç®¡ç†ä½“éªŒï¼